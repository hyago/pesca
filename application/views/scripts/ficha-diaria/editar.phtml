<?php
//$this->headScript()->appendFile('/js/jquery.maskedinput.min.js');
//$this->headScript()->appendFile('/js/mascaras.js');
?>

<div id="titulos">
    <h2>Desembarque->Ficha Diária</h2>
    <h3>Editar</h3>
</div>
<head>
    <script type="text/javascript">
        function jsEntrevista(nomeArtePesca, idMonitoramento, idFichaDiaria) {
            var Entrevista;
            if (nomeArtePesca.toLowerCase() === "Arrasto de Fundo".toLowerCase()) {
                Entrevista = "arrasto-fundo";
            }
            else if (nomeArtePesca == 'Calão') {
                Entrevista = 'calao';
            }
            else if (nomeArtePesca == 'Espinhel/Grosseira') {
                Entrevista = 'grosseira';
            }
            else if (nomeArtePesca == 'Pesca de Linha') {
                Entrevista = 'linha';
            }
            else if (nomeArtePesca == 'Rede de Emalhar') {
                Entrevista = 'emalhe';
            }
            else if (nomeArtePesca == 'Tarrafa') {
                Entrevista = 'tarrafa';
            }
            else if (nomeArtePesca == 'Vara de Pesca') {
                Entrevista = 'vara-pesca';
            }
            else if (nomeArtePesca == 'Jereré') {
                Entrevista = 'jerere';
            }
            else if (nomeArtePesca == 'Manzuá') {
                Entrevista = 'manzua';
            }
            else if (nomeArtePesca == 'Ratoeira') {
                Entrevista = 'ratoeira';
            }
            else if (nomeArtePesca == 'Catagem') {
                Entrevista = 'coleta-manual';
            }
            else if (nomeArtePesca == 'Mergulho') {
                Entrevista = 'mergulho';
            }
            else if (nomeArtePesca == 'Linha de Fundo') {
                Entrevista = 'linha-fundo';
            }
            else if (nomeArtePesca == 'Siripóia') {
                Entrevista = 'siripoia';
            }
            else
                Entrevista = 'error';
            var pag = (Entrevista + '/index');
            var tmpUpdate = (pag + '/id/' + idFichaDiaria + '/idMonitoramento/' + idMonitoramento);
            location.replace(tmpUpdate);
        }
        function jsDeleteMonitoramento(idMnt, frm, pag, fichaId) {
            var TmpUrl = (+fichaId + '#base');

            var tmpUpdate = (pag + '/id/' + idMnt + '/back_url/' + TmpUrl);

            if (confirm("Realmente deseja excluir este item?")) {
                location.replace(tmpUpdate);
            }
        }

        function jsInsertMonitoramento(frm, pag)
        {
            if (frm.QuantidadeEmbarcacoes.value) {
                var TmpUrl = (+frm.id_fichaDiaria.value + '#base');

                var tmpUpdate = (pag + '/SelectArtePesca/' + frm.SelectArtePesca.value + '/SelectMonitorada/' + frm.SelectMonitorada.value + '/QuantidadeEmbarcacoes/' + frm.QuantidadeEmbarcacoes.value + '/id_fichaDiaria/' + frm.id_fichaDiaria.value + '/back_url/' + TmpUrl);

                window.location.replace(tmpUpdate);
            }
        }
    </script>
</head>
<fieldset id="Desembarque">
    <div id="esquerda">
        <div id="form-esq">
            <label for="id">ID:</label>
            <input type="text" name="id_fichaDiaria" disabled="true" value="<?= $this->fichadiaria['fd_id'] ?>"/><br />
        </div>

        <div id="form-esq">
            <label for="tipo">Estagiário:</label>
            <select name="select_nome_estagiario" disabled="true">
                <?php
                foreach ($this->users as $key => $estagiario):
                    ?>

                    <option nome="nome_estagiario" value="<?= $estagiario['tu_id']; ?>"<?= ($estagiario['tu_id'] == $this->fichadiaria['t_estagiario_tu_id']) ? 'selected="selected"' : '' ?>><?= $estagiario['tu_nome'] ?></option>

                    <?php
                endforeach;
                ?>

            </select></br>
        </div>

        <div id="form-esq">
            <label for="tipo">Monitor:</label>
            <select name="select_nome_monitor" disabled="true">
                <?php
                foreach ($this->users as $key => $monitor):
                    ?>

                    <option nome="nome_monitor" value="<?= $monitor['tu_id']; ?>"<?= ($monitor['tu_id'] == $this->fichadiaria['t_monitor_tu_id1']) ? 'selected="selected"' : '' ?>><?= $monitor['tu_nome'] ?></option>

                    <?php
                endforeach;
                ?>
            </select></br>
        </div>

        <div id="form-esq">
            <label for="tipo">Data:</label>
            <input type="date" id="data_Viagem" placeholder="Data" name="data_ficha" disabled="true"value="<?= $this->fichadiaria['fd_data'] ?>"/><br />
        </div>

        <div id="form-esq">
            <label for="tipo">Turno:</label>
            <input disabled="true" nome="turno" <?= ('Matutino' == $this->fichadiaria['fd_turno']) ? 'value = "Matutino"' : 'value="Vespertino"' ?> >

        </div>


        <div id="form-esq">
            <label for="tipo">Porto:</label>
            <select name="select_nome_porto" disabled="true">
                <?php
                foreach ($this->dados_porto as $key => $porto):
                    ?>

                    <option nome="nome_porto" value="<?= $porto['pto_id'] ?>"<?= ($porto['pto_id'] == $this->fichadiaria['pto_id']) ? 'selected ="selected"' : '' ?> ><?= $porto['pto_nome'] ?></option>

                    <?php
                endforeach;
                ?>
            </select></br>
        </div>

        <div id="form-esq">
            <label for="tipo">Tempo: </label>
            <select name="select_tempo" disabled="true">
                <?php
                foreach ($this->dados_tempo as $key => $tempo):
                    ?>

                    <option nome="tempo" value="<?= $tempo['tmp_id'] ?>"<?= ($tempo['tmp_id'] == $this->fichadiaria['tmp_id']) ? 'selected ="selected"' : '' ?> ><?= $tempo['tmp_estado'] ?></option>

                    <?php
                endforeach;
                ?>
            </select><br/>
        </div>

        <div id="form-esq">
            <label>Vento:</label>
            <select name="select_vento" disabled="true">
                <?php
                foreach ($this->dados_vento as $key => $vento):
                    ?>

                    <option nome="tempo" value="<?= $vento['vnt_id'] ?>"<?= ($vento['vnt_id'] == $this->fichadiaria['vnt_id']) ? 'selected ="selected"' : '' ?> ><?= $vento['vnt_forca'] ?></option>

                    <?php
                endforeach;
                ?>

            </select><br/><br/>
        </div>

        <div id="form-esq">
            <label for="tipo">Observação:</label>
            <input type="text" id="obs" name="obs" disabled="true" value="<?= $this->fichadiaria['obs'] ?>"/><br />
            <br/>
        </div>

    </div>

    <br/>
    <br/>

</fieldset>
<form id="formulario" action="<?= $this->url(array("controller" => "ficha-diaria", "action" => "atualizar"), null, true) ?>" method="post">
    <fieldset class="noEditable"><legend>Monitoramento:</legend>
        <fieldset class="noEditable"><legend>Artes de Pesca e quantidade de embarcacoes:</legend>

            <div id="base">

                <input onclick="jsInsertMonitoramento(this.form, '<?= $this->url(array("controller" => "ficha-diaria", "action" => "insertmonitoramento"), null, true) ?>')" type="button" value="Add row" />

                <select id="tam_medio" name="SelectMonitorada" style="float:left">
                    <option   value="TRUE" selected="selected">Monitorada</option>
                    <option   value="FALSE">Não Monitorada</option>
                </select>

                <input type="number" name="QuantidadeEmbarcacoes" placeholder="Quantidade" size="10px">

                <input type="hidden" name="id_fichaDiaria"  value="<?= $this->fichadiaria['fd_id'] ?>"/>
                <select name="SelectArtePesca" id="artePesca">
                    <?php foreach ($this->artesPesca as $key => $artePesca): ?>
                        <option value="<?= $artePesca['tap_id']; ?>"><?= $artePesca['tap_artepesca']; ?></option>
                    <?php endforeach; ?>
                </select>
            </div>

        </fieldset>
        <br>
        <fieldset class="noEditable" id="itemArteTipoRows"><legend>Monitoramentos:</legend>
            <table id="monitoramento">
                <tr>
                    <th width="5%">Id_Monitoramento</th>
                    <th width="30%">Monitorada?</th>
                    <th width="20%">Arte de Pesca</th>
                    <th width="30%">Quantidade</th>
                    <th width="5%">Id_Ficha</th>
                </tr>
                <?php
                foreach ($this->vMonitoramento as $key => $vMonitoramento):
                    if ($vMonitoramento['mnt_monitorado'] == 1) {
                        $vMonitoramento['mnt_monitorado'] = "Sim";
                    } else {
                        $vMonitoramento['mnt_monitorado'] = "Não";
                    }
                    ?>
                    <tr id="itemEmbarcacoesRows<?= $key ?>">
                        <td name="inputIdMonitoramento"> <?= $vMonitoramento['mnt_id'] ?> </td>
                        <td name="inputMonitorada" > <?= $vMonitoramento['mnt_monitorado'] ?> </td>
                        <td name="inputArtedePesca"> <?= $vMonitoramento['tap_artepesca'] ?> </td>
                        <td name="inputQuantidade" > <?= $vMonitoramento['mnt_quantidade'] ?> </td>
                        <td name="inputIdFicha"> <?= $vMonitoramento['fd_id'] ?> </td>
                        <td><input type="button" class="button-del" width="5%" onclick="jsDeleteMonitoramento(<?= $vMonitoramento['mnt_id'] ?>, this.form, '<?= $this->url(array("controller" => "ficha-diaria", "action" => "deletmonitoramento"), null, true) ?>', <?= $vMonitoramento['fd_id'] ?>)"></td>
                        <td><input type="button" width="10%" target="_blank" value ="Nova Entrevista" onclick="jsEntrevista('<?= $vMonitoramento['tap_artepesca'] ?>', <?= $vMonitoramento['mnt_id'] ?>, <?= $vMonitoramento['fd_id'] ?>)"></td>

                    </tr>
                <?php endforeach; ?>
            </table>
        </fieldset>

    </fieldset>

</form>